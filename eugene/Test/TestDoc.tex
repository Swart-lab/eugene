\documentclass[a4paper,11pt]{article}

\usepackage[pdftex]{graphicx}
\usepackage{times}

\newcommand{\EuGenie}{\textsc{EuG{\`e}ne}}


\begin{document}
\setlength{\parindent}{0pt}

\title{Projet \EuGenie: Tests description}
\maketitle

This document updates the first version of July 23, 2003.
Due to insufficient buffer size memory with the spawn command for the SeqBig test, the SeqBig test is removed from the functionals tests and a new test Big (that used the same sequence as SeqBig, with a more complete list o
f sensors, that does not test the graph, and just test the stdout output) is defined in a new list called Arabidopsis also including the Araset test.

\section{Implemented tests}

\subsection{Units tests}
These tests test separetly each sensor. Using one sensor after the other (except for Est that requires also NG2 and for IfElse that uses NG2 and SPred), the detailed text outputs (-pd argument) are compared with a diff command (files are too long to use the spawn command) to a reference file.\\
A small file of araset is used for the test: seq14ac002535g4g5.tfa (8 Kb).\\
Theses tests are implemented in the eugene/Test/TestSuite/Units.exp file.\\

\subsection{Functional tests}
These tests test valid groups of sensors. Five tests described in the table on the following page are performed. \\
The textual output (except the 2 first lines due to version reference in them) is compare with a spawn command to a reference file and the graph generated is also compared to a reference file using there the diff command.  
Theses tests are implemented in the eugene/Test/TestSuite/Functionals.exp file.

\begin{center}
\begin{tabular}{|c|c|c|c|c|} \hline \hline
{\bf Functional Tests}& {\bf SeqAra}& {\bf SeqHom}& {\bf SeqDoc}& {\bf SeqRest}\\ \hline \hline

{\bf Sequences}& & & & \\ \hline \hline
seq25... (15 Kb)            & x &   &   & x   \\
(araset)                 &   &   &   &     \\ \hline 
exSeqHom.fasta (3 Kb)    &   & x &   &     \\ 
(EugeneHom)              &   &   &   &    \\ \hline 
SYNO\_ARATH.fasta (4 Kb) &   &   & x &     \\ 
(documentation)          &   &   &   &    \\ \hline 
chr1... (508 Kb)            &   &   &   &   \\ 
(bug)                    &   &   &   &    \\ \hline \hline 

{\bf Sensors}& & & & \\ \hline \hline
MarkovIMM      &       x        &                   &     x    &   \\ \hline
MarkovConst    &                &                   &          & x  \\ \hline
MarkovProt     &                &        x          &          &    \\ \hline
EuStop         &       x        &        x          &     x    & x \\ \hline
NStart         &       x        &                   &     x    &   \\ \hline
StartConst     &                &                   &          & x  \\ \hline
StartWAM       &                &        x          &          &    \\ \hline
NG2            & used by IfElse &                   &          &   \\  \hline
SPred          & used by IfElse &                   &          &   \\  \hline
GSplicer       &       x        &                   &          &   \\ \hline
SpliceConst    &                &                   &          & x  \\ \hline
SpliceWAM      &                &        x          &          &    \\ \hline
Est            &       x        &                   &          &   \\  \hline
Riken          &                &                   &          & x  \\ \hline
BlastX         &       x        &                   &          &   \\  \hline
Homology       &                &        x          &          &    \\ \hline
FrameShift     &                &                   &    x     &    \\ \hline
Transcript     &                &        x          &    x     &    \\ \hline
Repeat         &                &                   &          & x  \\ \hline
User           &                &        x          &    x     &    \\ \hline
GFF            &                &        x          &          &    \\ \hline
IfElse         &       x        &                   &    x     &   \\ \hline \hline

{\bf Arguments}& & & & \\ \hline \hline
E, B           &       x        &                   &          &   \\ \hline 
g              &       x        &        x          &    x     & x \\ \hline
\end{tabular}
\end{center}
\vspace{0.5cm}


\subsection{Arabidopsis tests}
Two tests are performed on Arabidopsis sequences, just checking the stdout outputs (no check of optimal path length).\\
The Araset test compares only the predictions realized on all the sequence of the araset set: /Annotation/Arabidopsis/araset/Genes. The sensors used are MarkovIMM, EuStop, NStart, IfElse, GSplicer, Est, BlastX.\\
The Big test checks the predictions done on the chr1\_2002.tfa\_22540000-23040000.tfa (508 Kb) file. The sensors used are MarkovIMM, Transcript, MarkovConst, EuStop, NStart, GSplicer, Est, BlastX.\\


\section{How to run tests}
It is first necessary to create a link named eugeneTest toward eugene:\\
         {\sf ln -s eugene eugeneTest}\\
\\
The 'check' target of Makefile lauches all the tests: {\sf make check}.\\
To specify only some tests, is it possible to use the Makefile TEST variable set with DejaGnu runtest arguments.\\
For example, to specify only 2 tests, type: \\
{\sf make check TEST='Units.exp Functionals.exp'} \\
or to forget a test, type: \\
{\sf make check TEST='--ignore ``Units.exp'''}\\
\\
If a test has failed, it is possible to examine difference between the coresponding
 reference file (in eugene/Test/Outputs directory) and the file obtained during test 
 (in eugene/Test/TestTrace directory).
For example, if the EuStop test has failed, type: \\
{\sf tkdiff -i ../Test/Outputs/Output\_EuStop ../Test/TestTrace/Output\_EuStop}\\
The -i argument allows to ignore case letter difference (see last section that details Linux and SUN OS difference).

\section{Test software sources organization}
All the test files are under the eugene/Test directory.
This directory contains 5 directories:
\begin{itemize}
\item {\bf Sequences}: contains all the sequences and the related information,
\item {\bf Outputs}: contains all the generated reference files,
\item {\bf config} (name imposed by DejaGnu): contains the scripts for generating reference files (GenerateOutputs.tcl), for common procedures and variables, for Dejagnu runtest initialisation (default.exp),
\item {\bf TestSuite}: contains the tests scripts (expect language),
\item {\bf TestTrace}: contains the DejaGnu test trace (files .sum and .log) and the files generated by tests that have failed, in order to be able to analyze the differences encountred.
\end{itemize}

\section{How to add others tests}
\begin{enumerate}
\item Describe the test in the Test/config/TestVar.tcl file\\
To add an other unit test for a new sensor: just complete the AllSensorsList variable.\\
To add a functional test: add the name in the FunctionalTestList variable and initialize the different variables indexed with the test name (see an existing test).\\
To add a different test: define required variables.\\
\item Update Test/config/GenerateOutputs.tcl to generate the corresponding reference files\\
To add an other unit or functional test: if 'simple' case, nothing to do else need to adapt or write code.
To add a different test: need to write adapted code.
\item Run Test/config/GenerateOutputs.tcl
\end{enumerate}

\section{Notes}
In July 2003, some differences exist between Linux (debian 3.0, gcc 2.95.4) and SUN OS (solaris 2.9, gcc 2.8.1). \\
\\
With SUN OS:
\begin{itemize}
\item options must be specified before sequences,
\item a name must be specified after the -g argument,
\item Inf is written instead of inf, diff is then used with the -i argument to ignore the case of letter,
\item optimal path value may be a little different (for MarkovProt test after the 4th decimal digit), the display of optimal path has been limited to 4 decimal digits.
\end{itemize}

In September 2004, some test results are differents depending on the used g++ compiler.\\
Output\_BlastX have a false 5130 line with g++ 2.95 and a true one with g++ 3.3 and higher.\\
In Output\_AraSeq, the value of the optimum path is slightly different with those 2 compilers.\\
\\
Due to the complete autoconfiscation of the software and the preparation of the diffusion as a debian package, the root of files is named eugene instead of EuGeneTk, the executable is called eugene instead of EuGeneAS, and it is no more necessary to create a EuGeneTest.par file to test the sofware.\\


\end{document}




